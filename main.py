import utils.cut_and_rm_sw
from cctopic import CCTopic

if __name__ == '__main__':
    topic = CCTopic(embedding_model_name='DMetaSoul/sbert-chinese-general-v2-distill', min_topic_size=8)
    topic.fit_model(doc_path='/home/dell/PycharmProjects/BERTopic/data/dx_xls/all1_cut.dat')
    topic.visualize(10)

    # docs = [
    # ';啊喂你好，请问是刘小军刘女士吗。;啊你好，我这边是上海益芯总部，我叫谢晓军工号109679。;给您这边来电话呢，是因为你在2019年嘛，在咱们公司有按揭过一款那个丰田卡罗拉还记得吧。;对。;呃，因为你这个车子是分36期还吗？这边马上就要结清了吗。;结清了会给您邮寄这个结清手续过来啊。;那个收件地址我这边跟您核对一下。;呃，你留的收件地址是广东？;广东省阳江市阳东县工业大道云山路28号。;金子园三栋303。;这个地址现在能收到吗？;他那些。;那后续这边结清了，会把这个结清手续给你正常邮寄过来，到时候你记得收一下。;另外稍后我会用我的微信加一下你，我会把你的车子信息、地址信息发给您，都核对一下。;如果到时候有什么不清楚的地方，您可以发微信联系到我这边好吧。;嗯，好的，行。;呃，这个手机号是您的微信号码吧。;好的，我的名字叫谢小军，你稍后通过一下好吧，我把您这个车子车子地址信息都要发给您核对一下。;那行。;这是第一个事情，呃，另外第二个事情呢，也非常重要，我这边给您通知到就可以了，做个简单了解，因为您是咱们的老客户了。;合作了也有三年的时间。;因为你这个还款记录呢，也是非常良好嘛，所以银行这边呢，他给你追加了一笔现金，可以供您使用。;额度呢是70720嘛，就7万多块钱。;这个钱呢，你这边申请成功以后呢，他是直接打到你的储蓄卡供您使用，因为本次回馈老客户嘛，全程办理都是免费给您办理的。;缅甸所有的手续费服务费到账就是70720。;你看没问题，这边可以帮您申请一下。;嗯。;就你分期来还吗？你可以分为12期，24期，36期都是可以的。;在你分期的时候嘞。;呃，如果你他他是这样的啊姐姐他最长呢是可以分为36期的。;如果你中途用着用着不用了，他在六个月或者12个月以后，你也可以提前还的。;提前还了，也只还剩余的本金，所以这个很方便。;那服务费手续费全免全免。;就是。;他不是你的额度是70720嘛，他到账就是70720。;你说的后面用的费用对吧。;后面用的费用是很便宜很便宜的，像你平时有用过这个花呗或者信用卡的产品，有用过吗？;像花呗信用卡的这些产品，它的费用是在一个万分之五到万分之六嘛，这个你应该知道。;那本次这个现金款项给到你了，它的费用只在一个万分之三。;反正你用一个月算一个月的，现在只有他们的一半。;而且呢，它是现金打到你的储蓄卡里面的，您到时候分期来还就可以了，这个就很方便。;他不需要打那个，你提供什么银行流水啊，打卡工资啊。;什么社保啊，公积金这些材料啊。;直接在线办理就可以了，办理完成后最快当天就可以到账的，这个很方便的。;对直接在线办理，办理成功后，这个钱直接就打到你的卡里面，打到你卡里面呢，你自己去安排使用就可以了，它也不影响你的呀。;就他也不会打什么回访电话呀，不需要你提供什么银行流水啊，打卡工资这些啊，直接就可以在线给你办理，因为你是老客户了嘛。;他本来就是银行回馈给老客户的。;是一个客户呢，就这么一个名额的。;呃，这样吧，姐姐，你通过一下我的那个微信，我把你的证件发给你做一个核对。;核对没有问题，我给您提交系统做个预审吗，他一分钟就可以出结果。;如果预审通过的话，这个钱就可以领回去用的，好吧。;嗯。;你这个我加你了，我的名字叫谢小娟，你通过一下，我会把你车子信息，地址信息都发给您，包括我的那个工作证件，我都发给您好吧。;好那咱们微信联系嘛，到时候我把您证件也发给你，发给你做个核对。;核对没有问题了，我就给你提交做预审，预审能够通过的话，这个就可以办理了，好吧。;我看你这边已经通过了对吧。;好的，行。;呃，我把我的那个证件那些都发给你，你可以保存一下。;包括我的那个。;稍等啊。;我把你的证件也要发给你，发给你做个核对，没有问题的话，我就给您提交做个预审好吧。;就是我把你的那个。;呃，车子地址信息我发给您做一个核对。;你微信现在能收到吧。;我看一下。;嗯，好。;我把地址发给你。;我车子信息，地址信息都发给你了，你看到没有？;嗯，你核对下。;嗯，好的，那咱们微信联系吧，好吧。;好好好，再见姐姐，嗯，好。;嗯，没有。',
    # ';喂，你好，请问是吴飞飞吴女士吗？;啊你好，我这边是上海益兴总部，我叫谢晓军工号109679。;给你们这边来电话是因为您在2019'
    # '年在咱们公司有按揭过一款那个丰田雷凌还记得吗？;呃，因为你这个车子不是马上要结清了吗？结清后会给你邮寄这个结清手续过来那个地址，跟您核对一下收件地址。;对呀。;大哥。;大哥你你你怎么怎么这个这个这个怎么。;这个心情不好吗？;哦，没有没有，因为你那个车子不是之前在咱们这边按揭的吗。;按揭的，然后现在不是要那个结清啦，要结清了，要给你们邮寄这个结清手续吗？;那个地址我跟你核一下，你之前留的地址，你看现在还能不能收到。;你之前留的是山东省临沂市费县。;薛庄镇。;天蒙景区。;嗯，这样吧。;如果地址要改变了，这样，因为我这边呢是负责你们这个车子啊，结清手续的那个通知，我稍后会用微信加一下你们，我把你的地址，车子信息都要发给你们做核对，如果你要改地址，你就重新发个地址给我就可疑，我这边重新帮你登记，您看这样可以吗。;好的行，这个手机号152的是您的微信号码吗。;好的我的名字叫谢小军，你稍后通过一下好吧。;好的。;如果后续你这边没收到，或者有什么不清楚的地方，你都可以发微信联系我这边的。;好的行，这是第一个事情，另外第二个事情呢，我给你带着就可以了，你可以做个了解。;因为你是咱们的老客户了，合作也有三年的时间。;因为你们这个还款记录吗，一直是非常良好，从来没产生过任何的逾期。;所以说银行这边呢，他是给你们追加了一笔现金，可以供你们使用的。;额度呢是七万两千八百八六七万块钱吗。;这个钱呢，你们申请成功以后，是直接打到你们储蓄卡，供你们使用。;因为本次回馈老客户嘛，全程免费。;就是免费办理，不需要收任何的手续费服务费的。;您看没问题，这边可以帮你们申请一下。;呃，72880就7万块钱嘛。;13000块钱。;分期还呀，你可以分为12期，24期，36期都是可以的，但是不管你分多少期啊，你六个月以后你不用了，对吧，比如说你短期周转六个月以后，你不用了，你都可以提前还。;所以说，不管你就是说你可以常用也可以短用都可以，最长的可以用三年，最短的可以用六个月都可以的。;这个要看你分多少期了。;这个费用吗。;就像你平时我，呃对问题我想了解一下，你平时使用这个花呗，信用卡有用过吗。;好的，这个费用是在万分之三就1万块钱，一天就是三块钱，你用多久算多久。;那没有其他的。;没有其他任何费用。;嗯，好的行，那个你的我加了，你通过一下，我把这些都发给你自己那个做个参考嘛，他是在那个，他不需要你提供银行流水，打卡工资啊，公积金社保这些。;他直接在线办理的，办理成功以后，最快当天可以到账。;那他这个名额嘛，他因为是回馈名额，在你的车子结清之前，你是可以直接申请的，结清之后他这个名额也会自动取消，所以我把这些都通知到你嘛，好吧。;好的行，那您通过一下微信，我发给你就可以。;嗯，好的好的再见啊。',
    # ';喂，你好，请问是。;铭洋附近。;啊你好，我这边是上海益兴总部的，我叫谢晓，军工号109679。;给您这边来电话呢，是因为您在2019年嘛，在咱们公司有按揭过一款那个长安CS，五五还记得吗。;是这样的，因为你这个车子分36期还吗？这边不是马上就要结清了嘛，对吧。;呃结清以后呢，咱们会给您邮寄这个结清手续过来。;那个收件地址我跟您核一下。;呃，你之前登记了一个收件地址，是山东省聊城市。;东阿县刘集镇雅副食村。;然后46号这个地址现在能收吗。;哦，对对。;崔富时村46号，刚读错啦。;最近的能收吗？;哦对对对，我看到你在那个小程序里面那个登记的嘛，对不对吗。;对对对。;呃他这个地址现在能收到吗？对吧。;好的，那后续你这边结清以后呢，咱们会把那个手续给您正常的邮寄过来，好吧。;邮寄过来，稍后我会用我的微信加一下你，我会把你那个车子的信息，地址信息再发给你核对一下。;包括后续啊，如果你这边没收到，你都可以发微信联系我的。;这个手机号152的，这个是你的微信号码吧。;我的头像是两个孩子吗？;好的我加你一下，我的名字叫谢小军，你通过一下，稍后我把那个车子地址信息都发给您，您核对一下好吧。;好的，行。;这第一个事情，另外第二个事情呢，我也给您带到嘛，非常重要，你可以做个简单的了解。;因为您是咱们的老客户了，合作了也有三年的时间。;因为你的还款记录呢也是非常良好嘛，所以银行这边呢，他是给你追加了一笔。;现金给到您使用。;额度呢是58960，就将近6万块钱。;这个钱呢，你这边申请成功以后呢，他是直接打到你的储蓄卡里面。;因为本次回馈老客户嘛，全程办理都是免费给你办理的，免掉所有的手续费，服务费到账就是58960。;你看没问题，这边可以帮你申请一下。;是这样的，他那个车子啊，他不清二次抵押，只是说你那个手续吗，和以前一模一样，他继续放在这边就可以了。;这个很简单的，他也不会进行你来审车呀，也不会重新装GPS啊，因为它是直接追加吗？因为你的还款记录还可以，所以银行这边直接给你追加，他也是希望和咱们老客户嘛，搭建长期的合作关系，我这么说能够理解吧。;所以说他不需要你提供什么银行流水啊，打卡工资啊，公积金啊，社保啊，直接在线给你办就可以了，办理完成后最快啊，当天就可以把这笔钱打给你使用的。;这个能理解吧。;啊，不是不是，他是在你的车子结清之前，他是可以直接办理的，结清之后呢，他的名额会取消，为什么呢？因为它是针对咱们老客户的，只针对老客户，因为它这个全程办理吗？不收你任何的手续服务费，比如说你申请多少，它到账就多少一分钱不收你的明白了吧。;这个就很低很低了，像你平时有用过这个花呗啊，那个信用卡之类有用过吗。;像那个花呗信用卡，你知道吗？这个他这费用是在一个万分之五到万分之六对吧。;啊。;那行，那你通过通过一下微信吧，我那个发给你。;你中午来的时候可以看一下好吧。;好好好好嗯，好好再见啊好。',
    # ';哎，你好是张峰张先生是吧。;哎，你好张先生，一星集团的工作人员哈，我叫陈亮，工号是109269。;那刚刚给您说一下哈，你这边是。;融资金额的话是。;162480块钱，融资期数是36期。;就每月月租金哈，是5792.05元哈。;对对对，就刚刚给您讲的就这个哈。;哎行，那我跟你讲清楚哈，那这边刚我也这边说错了哈，那这边没什么事情了，好吧。;哎，对对，我要跟您约在电话里面要跟你讲清楚的好吧。;哎，好好嗯，再见哈，嗯感谢您接听。;生活愉快，嗯，再见。',
    # ';呃，张文文本人对吗？;哎，我这边是益兴的工作人员，小姐你好。;这边刚才不是通过线下扫码给我们提交了一个车子借款申请吗。;来电话就是来帮助帮张姐您办这个申请业务的啊。;张先生名下的这个车子目前是全款车吗？;结清了，那就属于全款车，当时买车的时候大概裸车价是多少钱？记得吧，裸车价。;嗯，您说。;对，裸车价大概多少钱？;哎，你好你好你说。;哦61万左右啊，我这边我以为你跟他说话呢。;61万左右，目前买几年了呢大概。;四年左右时间是吧，车子完全没问题。;办的啊。;现在南方。;您是上班的还是做生意的？;你现在在南通呢？这个职业啊，是上班的还是做生意的呢？;呃属于那个营业执照有注册吗？;法人代表是你本人还是你家人啊？法人就代表这个。;是你的名字是吧？没问题，可以办，那您名下的话目前有没有商品房呢，有吗。;有买过吗？;有了。;有房子是吧，好的没问题，可以办，我简单跟您说一下我们的方案，第一个我们的费用这一块。;1万块钱一个月就只有78块钱，就划到每天才两块六。;除此之外，别的任何额外的服务费、手续费都没有。;申请金额多少也都是满额到账一分不少的理解吧？;对对对对。除此之外，其他任何额外的费用都没有，申请金额多少也都是满额到账。;呃，然后还款方式就是分期还最长分三年一年两年三年都行。;放款的额度这一块主要是按照你这个车子目前市场评估价最高，可以帮您按照八成来帮您做申请。;比如说你这个车子目前值10万，那就帮你办8万，如果值30，那就帮您办24，以此类推做吧，重最高知道吧。;目前接下来针对于额度呀，还款方式呀，费用这一块都听懂了吧，张姐。;嗯，好的，你这个手机号码是你的微信号码，1139这个。;对，我加您微信，稍后您把您车辆的行驶证照片先发给我，我先给你估。;对我先给您估个车价，做个预审。;十分钟左右。;看结果能不能办，能办多少钱大概就出来了，好吧。;我加了通过微信。;嗯，好再见啊再见。',
    # ';哎喂你好，请问是那个林俊廷林呃林先生是吗。;啊林先生您好，我这边是那个上海益兴集团的一个服务顾问杨晨，您目前的一个审批已经通过，跟您来电，就是要跟您确认一下本次办理的相关信息，为了改善服务质量，保障您的权益，以下通话会有录音，并且保证感谢您的配合，本次业务办理人是林俊廷，车子也是在名下，对吧。;呃，您本次办理的是u这种产品，您这边的话融资总额是20万元，融资期限是36期，咱们这个月供是7129.55元。;其中包含月担保费零元，这个你都了解了对吧。;呃，和您说一下，我们这边是汽车融资业务，需要办理抵押登记，也就是抵押那个绿本，这个都了解了对吧。;哦，好的，之后我们会有当地的工作人员联系您办理抵押和装GPS啊，办理好之后就能帮您全款了，最快当天就可以到账。;呃，请问您这边呃，您这边是根据您目前个人资质情况，系统显示银行无法通过你的审批贷款，目前是可以通过苏宁金珠融资租赁模式为您提供所需的一个资金，资金仍然可以打到您这边个人账户里面去，您需要和那个苏宁金珠签署融资租赁相关协议，这个这边先告诉你，这个都了解了对吧。;呃，请问您这边是通过那个什么渠道申请这个业务呢？是您本人申请的，还是什么其他中介人给您介绍的呢。;呃，那您申请过程当中，除了我有人向您索要过什么银行卡信息之类的吗，有吗？;呃，除了300元的一个档案管理费之外，您这边是否支付过额外的一个费用呢。;好的，提醒您一下，您现在审批通过是因为你本身的一个资质完全符合我们公司的一个办理要求，整个办理过程当中，你唯一需要支付的是那个300元的一个档案管理费，除此之外是没有任何额外的一个费用，后续款项咱们是这边是会放到您这边个人银行卡上，一心或者银行不会无故将您的款项收回，所以如果有人向你收取额外的一个费用，你一定要如实告知，并且拒绝支付，这样并不影响您本次业务的一个办理，以上都清楚了吗？;哦，好的，您这边有没有关注一下我们那个微信公众号叫易鑫车主服务呢？;哦，如果没有我这边推，到时候推送给你好吧。;哦，您关注了这个微信公众号之后啊，可以通过它下载电子版合同，另外您办理成功之后，会有工作人员给您回访，到时候您注意接听一下一个回访电话好吧。;哦，因为这个是宿营金素给您放款，宿营接触咱们这个提醒还款的要求，我再次跟您说一下，这个是必须用满半年，半年以后方可提醒还款，到时候您您这边是需要支付那个固定的一个1500元的一个手续费，另外呢，再加上未还的一个本金，呃就行了，这个你都了解了对吧。;呃，您这边的话有什么问题啊，可以随时联系我，或者拨打我们公司的客服热线，943个0598598这边就先不打扰你了，等今天钱到账以后，每月正常还达到月供就行了好吧。;哦，感谢您的接听，祝您生活愉快，再见，我马上安排啊，好吧。;嗯，没参加，拜拜。']

    docs = [';哎。;张梦林女士您好，我这边是上海益芯的服务顾问王小龙，工号109958。;感谢您对艺星的认可，接下来呢，我需要跟您核对一下。;此次办理的业务的合同信息，为了改善服务质量，保障您的权益，以下通话会有录音并保存。;此次分期办理人是张梦琳女士，这款车也是本人在使用，且车牌号是鄂C53346，对吗？;之前办理的城市是湖北十堰，现在还在实验这个城市工作居住吗？;嗯，本次融资租赁的合同编号为7499。;868895杠零一对吗？;嗯，跟您核对一下，此次给您办理的是我们益兴啊，针对老客户推出的金融产品。;融资金额是55600元。;分期您这边是分了36期，每期的金额为两千零。;76.75元。;其中包含每期的139元的担保费。',
';放款卡还是之前分期还款卡，银行卡号不变，还款日是您放款日的次月，跟您核对一下没有问题吧？;好的，一星或者其他机构没有向您本人收取过其他额外的费用，对吗？;您这边是我们的优质老客户，此次给您办理业务的相关信息，与之前新车时。;新车分期时留下的这个信息是否发生过变化呢？;啊，好嘞，为了保障您的权益，接下来的内容需要您在通话中读出来，我读一句，您跟着我读一句没有问题吧。;艺兴的。;或合作经销商的。;工作人员。;已向我详细解释。;融资合同条款。;及确认函内容。;及以及的及及确认函内容。;及确认函。;及确认函内容。;对。;我已阅读。;理解并同意。;合同条款。;融资租赁关系。;朱莉。;融资租赁关系。;知晓并愿意。;知晓并愿意。;承担每一项费用。;支付及金额。;确认签署的是。;融资租赁合同。;朱莉。;租赁合同。;哎，好的。;对对对，感谢感谢您的配合啊嗯，好的，之后您有任何问题可以致电我们的客服热线。',
';四三个0598598，另外，您这边有没有关注我们的微信公众号一新车主服务呢。;嗯，好的，您关注了这个公众号之后啊，您可以通过它来下载电子版的合同，微信我们这边已经加好了，有什么问题，我们微信沟通注意。;以后每个月的正常还款。;哦，跟您特别说明一下，业务办理成功之后，您车辆的登记证会继续放在我们公司。;那您这边当时帮您匹配的是民生金租，使用六个月之后是可以提前还款，提前还款。;没有，没有违约金，就只需要还剩余本金就可以了。;这个您听清楚听清楚了吗。;每个月的月供金额为2076.75元。;后续您可以下载一下电子合同电子版的合同上面会有的，这个您放心。;在我们的微信公众号上面就可以下载了。;啊，感谢您的接听，祝您生活愉快，再见。'
            ]
    stopwords = utils.cut_and_rm_sw.get_stopwords('/home/dell/PycharmProjects/BERTopic/dicts/')

    cutted_docs = [utils.cut_and_rm_sw.cut_sentence(doc, drop_threshold=0, sw_set=stopwords) for doc in docs]

    # topic.topic_threshold = 0
    for doc, cnt in cutted_docs:
        docs = []
        if cnt != 0:
            docs.append(doc)
            print(docs)
            print(topic.inference(docs))
